# 관리자 페이지 구현 계획

## 개요

"뭐입지" 서비스의 관리자 페이지 구현 계획서입니다.

---

## 1. 구현 범위

### 핵심 기능 (Phase 1)

| 기능            | 설명                       | 우선순위 |
| --------------- | -------------------------- | -------- |
| **대시보드**    | 주요 지표 한눈에 보기      | P0       |
| **사용자 관리** | 회원 목록, 상세, 상태 변경 | P0       |
| **구독 관리**   | 구독 현황, 결제 이력       | P0       |
| **상품 관리**   | 상품 CRUD                  | P1       |

### 확장 기능 (Phase 2)

| 기능            | 설명           | 우선순위 |
| --------------- | -------------- | -------- |
| **분석/통계**   | 차트, 리포트   | P1       |
| **콘텐츠 관리** | 공지사항, 배너 | P2       |
| **시스템 설정** | 권한, 로그     | P2       |

---

## 2. 기술 스택

### 기존 스택 유지

- **React 18** + TypeScript
- **React Router DOM** (중첩 라우팅)
- **Tailwind CSS** (기존 디자인 시스템)
- **Lucide React** (아이콘)

### 추가 라이브러리 (선택)

| 라이브러리              | 용도        | 필수 여부 |
| ----------------------- | ----------- | --------- |
| `recharts`              | 차트/그래프 | 권장      |
| `@tanstack/react-table` | 테이블      | 권장      |
| `date-fns`              | 날짜 포맷팅 | 권장      |

---

## 3. 라우팅 구조

```
/admin                    → 대시보드 (리다이렉트)
/admin/dashboard          → 대시보드
/admin/users              → 사용자 목록
/admin/users/:id          → 사용자 상세
/admin/subscriptions      → 구독 관리
/admin/payments           → 결제 내역
/admin/products           → 상품 목록
/admin/products/new       → 상품 등록
/admin/products/:id       → 상품 수정
/admin/analytics          → 분석/통계
/admin/settings           → 설정
```

---

## 4. 파일 구조

```
src/
├── admin/
│   ├── components/           # 관리자 전용 컴포넌트
│   │   ├── AdminLayout.tsx   # 레이아웃 (사이드바 + 헤더)
│   │   ├── AdminSidebar.tsx  # 좌측 네비게이션
│   │   ├── AdminHeader.tsx   # 상단 헤더
│   │   ├── StatsCard.tsx     # 통계 카드
│   │   ├── DataTable.tsx     # 공통 테이블
│   │   ├── SearchInput.tsx   # 검색 입력
│   │   ├── Pagination.tsx    # 페이지네이션
│   │   ├── Modal.tsx         # 모달
│   │   └── ConfirmDialog.tsx # 확인 다이얼로그
│   │
│   ├── pages/                # 관리자 페이지
│   │   ├── Dashboard.tsx     # 대시보드
│   │   ├── UserList.tsx      # 사용자 목록
│   │   ├── UserDetail.tsx    # 사용자 상세
│   │   ├── Subscriptions.tsx # 구독 관리
│   │   ├── Payments.tsx      # 결제 내역
│   │   ├── ProductList.tsx   # 상품 목록
│   │   ├── ProductForm.tsx   # 상품 등록/수정
│   │   ├── Analytics.tsx     # 분석
│   │   └── Settings.tsx      # 설정
│   │
│   ├── hooks/                # 관리자 전용 훅
│   │   ├── useAdminAuth.ts   # 관리자 인증
│   │   ├── usePagination.ts  # 페이지네이션
│   │   └── useSearch.ts      # 검색/필터
│   │
│   └── utils/                # 유틸리티
│       ├── formatters.ts     # 포맷팅 함수
│       └── constants.ts      # 상수
│
├── components/
│   └── RouteGuard.tsx        # AdminRoute 추가
│
└── context/
    └── AuthContext.tsx       # role 필드 추가
```

---

## 5. 인증 시스템 확장

### User 타입 확장

```typescript
// AuthContext.tsx 수정
type UserRole = "user" | "admin" | "super_admin";

interface User {
  id: string;
  email: string;
  name: string;
  role: UserRole; // 추가
  subscription: Subscription;
}
```

### AdminRoute 컴포넌트

```typescript
// RouteGuard.tsx에 추가
export function AdminRoute({ children }: { children: ReactNode }) {
  const { user } = useAuth();

  if (!user) {
    return <Navigate to="/admin/login" replace />;
  }

  if (user.role !== "admin" && user.role !== "super_admin") {
    return <Navigate to="/" replace />;
  }

  return <>{children}</>;
}
```

---

## 6. 레이아웃 설계

### AdminLayout 구조

```
┌─────────────────────────────────────────────────────────┐
│  AdminHeader (로고, 검색, 알림, 프로필)                    │
├────────────┬────────────────────────────────────────────┤
│            │                                            │
│  Sidebar   │              Main Content                  │
│            │                                            │
│  - 대시보드  │   ┌────────────────────────────────────┐  │
│  - 사용자   │   │  Page Header (제목, 액션 버튼)      │  │
│  - 구독    │   ├────────────────────────────────────┤  │
│  - 결제    │   │                                    │  │
│  - 상품    │   │         Page Content               │  │
│  - 분석    │   │                                    │  │
│  - 설정    │   │                                    │  │
│            │   └────────────────────────────────────┘  │
│            │                                            │
└────────────┴────────────────────────────────────────────┘
```

### 반응형 대응

- **Desktop (1024px+)**: 사이드바 고정
- **Tablet (768px-1023px)**: 사이드바 접힘 가능
- **Mobile (767px-)**: 햄버거 메뉴

---

## 7. 페이지별 상세 설계

### 7.1 대시보드

```
┌─────────────────────────────────────────────────────────┐
│  대시보드                                      [새로고침] │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │
│  │ 총 회원  │ │ 활성 구독 │ │ 이번달 매출│ │ 오늘 가입 │   │
│  │  1,234  │ │   567   │ │ ₩5.6M   │ │   12    │   │
│  │  +12%   │ │  +5%    │ │  +8%    │ │  -3%    │   │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │
│                                                         │
│  ┌─────────────────────────┐ ┌─────────────────────────┐│
│  │   매출 추이 (차트)        │ │   구독 현황 (도넛)       ││
│  │                         │ │                         ││
│  │   📈                    │ │      🍩                 ││
│  │                         │ │   Free: 60%             ││
│  │                         │ │   Basic: 25%            ││
│  │                         │ │   Pro: 15%              ││
│  └─────────────────────────┘ └─────────────────────────┘│
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │  최근 가입 회원                          [전체보기 →] ││
│  ├─────────────────────────────────────────────────────┤│
│  │  이름        이메일              가입일     플랜     ││
│  │  홍길동      hong@email.com     2025-01-15  Free    ││
│  │  김철수      kim@email.com      2025-01-15  Basic   ││
│  └─────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

**표시 데이터:**

- 총 회원 수 (전월 대비 증감)
- 활성 구독자 수
- 이번 달 매출
- 오늘 신규 가입
- 매출 추이 그래프 (최근 7일/30일)
- 플랜별 구독 비율
- 최근 가입 회원 5명

---

### 7.2 사용자 관리

```
┌─────────────────────────────────────────────────────────┐
│  사용자 관리                                  [CSV 내보내기]│
├─────────────────────────────────────────────────────────┤
│  [🔍 검색...]  [플랜 ▼] [상태 ▼] [가입일 ▼]  [초기화]    │
├─────────────────────────────────────────────────────────┤
│  □  이름      이메일           플랜    상태   가입일      │
│  ─────────────────────────────────────────────────────  │
│  □  홍길동    hong@email.com   Pro    활성   2025-01-15 │
│  □  김철수    kim@email.com    Basic  활성   2025-01-14 │
│  □  이영희    lee@email.com    Free   정지   2025-01-13 │
├─────────────────────────────────────────────────────────┤
│  선택: 0개                    ◀ 1 2 3 ... 10 ▶  20개씩   │
└─────────────────────────────────────────────────────────┘
```

**기능:**

- 검색 (이름, 이메일)
- 필터 (플랜, 상태, 가입일 범위)
- 정렬 (가입일, 이름)
- 페이지네이션
- 일괄 선택/작업
- CSV 내보내기

**사용자 상세:**

```
┌─────────────────────────────────────────────────────────┐
│  ← 사용자 상세                         [수정] [정지/해제] │
├─────────────────────────────────────────────────────────┤
│  ┌──────┐                                               │
│  │  👤  │  홍길동                                        │
│  └──────┘  hong@email.com                               │
│            가입일: 2025-01-15                            │
├─────────────────────────────────────────────────────────┤
│  구독 정보                                               │
│  ┌─────────────────────────────────────────────────────┐│
│  │  플랜: Pro (₩19,900/월)                              ││
│  │  시작일: 2025-01-15                                  ││
│  │  다음 결제일: 2025-02-15                             ││
│  │  상태: 활성                          [구독 취소]      ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  저장한 코디 (5개)                          [전체보기 →] │
│  ┌─────┐ ┌─────┐ ┌─────┐                               │
│  │ 코디 │ │ 코디 │ │ 코디 │                               │
│  └─────┘ └─────┘ └─────┘                               │
│                                                         │
│  결제 이력                                              │
│  ┌─────────────────────────────────────────────────────┐│
│  │  날짜        금액      상태      결제수단             ││
│  │  2025-01-15  ₩19,900  완료      카드 ****1234       ││
│  └─────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

---

### 7.3 구독 관리

```
┌─────────────────────────────────────────────────────────┐
│  구독 관리                                               │
├─────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │
│  │ 전체 구독 │ │ Basic   │ │ Pro     │ │ 만료 예정 │   │
│  │   567   │ │   320   │ │   247   │ │   45    │   │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │
├─────────────────────────────────────────────────────────┤
│  [🔍 검색...]  [플랜 ▼] [상태 ▼]                         │
├─────────────────────────────────────────────────────────┤
│  사용자       플랜    시작일      종료일      상태        │
│  ─────────────────────────────────────────────────────  │
│  홍길동       Pro    2025-01-15  2025-02-15  활성        │
│  김철수       Basic  2025-01-10  2025-02-10  활성        │
│  이영희       Pro    2023-12-01  2025-01-01  만료        │
└─────────────────────────────────────────────────────────┘
```

---

### 7.4 상품 관리

```
┌─────────────────────────────────────────────────────────┐
│  상품 관리                                    [+ 상품 등록]│
├─────────────────────────────────────────────────────────┤
│  [🔍 검색...]  [카테고리 ▼] [브랜드 ▼] [상태 ▼]          │
├─────────────────────────────────────────────────────────┤
│  이미지  상품명              브랜드    카테고리  가격      │
│  ─────────────────────────────────────────────────────  │
│  [📷]   오버핏 옥스포드 셔츠   무신사    Top     ₩59,000  │
│  [📷]   와이드 슬랙스         커버낫    Bottom  ₩79,000  │
│  [📷]   레더 스니커즈         컨버스    Shoes   ₩51,000  │
└─────────────────────────────────────────────────────────┘
```

**상품 등록/수정 폼:**

```
┌─────────────────────────────────────────────────────────┐
│  ← 상품 등록                                    [저장]   │
├─────────────────────────────────────────────────────────┤
│  기본 정보                                               │
│  ┌─────────────────────────────────────────────────────┐│
│  │  상품명 *     [                              ]       ││
│  │  브랜드 *     [선택하세요              ▼]            ││
│  │  카테고리 *   ○ Top  ○ Bottom  ○ Shoes              ││
│  │  가격 *       [              ] 원                   ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  이미지                                                 │
│  ┌─────────────────────────────────────────────────────┐│
│  │  ┌─────────┐                                        ││
│  │  │  + 업로드 │  드래그 앤 드롭 또는 클릭하여 업로드     ││
│  │  └─────────┘                                        ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  외부 링크                                               │
│  ┌─────────────────────────────────────────────────────┐│
│  │  구매 링크    [https://musinsa.com/...       ]      ││
│  │  외부 ID     [                              ]       ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  상태                                                   │
│  ┌─────────────────────────────────────────────────────┐│
│  │  [✓] 판매 가능                                      ││
│  └─────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

---

## 8. 공통 컴포넌트 설계

### 8.1 DataTable

```typescript
interface DataTableProps<T> {
  data: T[];
  columns: Column<T>[];
  loading?: boolean;
  selectable?: boolean;
  onSelect?: (selectedIds: string[]) => void;
  pagination?: PaginationProps;
  emptyMessage?: string;
}
```

### 8.2 StatsCard

```typescript
interface StatsCardProps {
  title: string;
  value: string | number;
  change?: number; // 전월 대비 변화율
  changeLabel?: string;
  icon?: LucideIcon;
  color?: "orange" | "blue" | "green" | "red";
}
```

### 8.3 SearchInput

```typescript
interface SearchInputProps {
  value: string;
  onChange: (value: string) => void;
  placeholder?: string;
  debounceMs?: number; // 디바운스 시간
}
```

### 8.4 Pagination

```typescript
interface PaginationProps {
  currentPage: number;
  totalPages: number;
  pageSize: number;
  totalItems: number;
  onPageChange: (page: number) => void;
  onPageSizeChange?: (size: number) => void;
}
```

---

## 9. 구현 일정

### Phase 1: 핵심 기능 (5일)

| 일차  | 작업 내용                                        |
| ----- | ------------------------------------------------ |
| 1일차 | 인증 확장 (role), AdminRoute, AdminLayout        |
| 2일차 | 공통 컴포넌트 (DataTable, StatsCard, Pagination) |
| 3일차 | 대시보드 페이지                                  |
| 4일차 | 사용자 관리 (목록, 상세)                         |
| 5일차 | 구독/결제 관리                                   |

### Phase 2: 확장 기능 (3일)

| 일차  | 작업 내용               |
| ----- | ----------------------- |
| 6일차 | 상품 관리 (CRUD)        |
| 7일차 | 분석/통계 (차트)        |
| 8일차 | 설정, 테스트, 버그 수정 |

---

## 10. 모의 데이터

현재 프론트엔드만 구현하므로, 모의 데이터를 사용합니다.

```typescript
// admin/utils/mockData.ts

export const mockUsers = [
  {
    id: "1",
    email: "hong@email.com",
    name: "홍길동",
    role: "user",
    subscription: { plan: "pro", isActive: true, ... },
    createdAt: "2025-01-15",
  },
  // ...
];

export const mockStats = {
  totalUsers: 1234,
  activeSubscriptions: 567,
  monthlyRevenue: 5600000,
  todaySignups: 12,
};

export const mockProducts = [
  {
    id: "1",
    name: "오버핏 옥스포드 셔츠",
    brand: "무신사 스탠다드",
    category: "top",
    price: 59000,
    imageUrl: null,
    isAvailable: true,
  },
  // ...
];
```

---

## 11. 스타일 가이드

### 색상

| 용도      | 색상    | Tailwind          |
| --------- | ------- | ----------------- |
| 주 액센트 | #FB5010 | `bg-[#FB5010]`    |
| 성공      | #22C55E | `text-green-500`  |
| 경고      | #EAB308 | `text-yellow-500` |
| 위험      | #EF4444 | `text-red-500`    |
| 정보      | #3B82F6 | `text-blue-500`   |

### 버튼 스타일

```typescript
// Primary
"bg-[#FB5010] text-white hover:bg-[#E04600]";

// Secondary
"bg-[#1a1a1a] text-white hover:bg-[#333]";

// Outline
"border-2 border-gray-200 hover:border-gray-400";

// Danger
"bg-red-500 text-white hover:bg-red-600";
```

### 테이블 스타일

```typescript
// 테이블 헤더
"bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider";

// 테이블 행
"hover:bg-gray-50 transition-colors";

// 테이블 셀
"px-6 py-4 whitespace-nowrap text-sm";
```

---

## 12. 보안 고려사항

1. **관리자 인증**

   - 별도 로그인 페이지 (`/admin/login`)
   - 세션 타임아웃 (30분)
   - 로그인 시도 제한

2. **권한 검증**

   - 모든 관리자 라우트에 AdminRoute 적용
   - API 호출 시 권한 확인

3. **감사 로그**

   - 주요 작업 로깅 (사용자 상태 변경, 구독 수정 등)

4. **CSRF/XSS 방지**
   - 기존 sanitizeInput 활용
   - 민감한 작업에 확인 다이얼로그

---

## 결론

### 구현 순서 제안

1. **1단계**: 인증 확장 + 레이아웃
2. **2단계**: 공통 컴포넌트 (테이블, 카드, 페이지네이션)
3. **3단계**: 대시보드
4. **4단계**: 사용자 관리
5. **5단계**: 구독/결제 관리
6. **6단계**: 상품 관리
7. **7단계**: 분석/통계

### 트레이드오프

| 선택지                 | 장점                            | 단점                             |
| ---------------------- | ------------------------------- | -------------------------------- |
| **기존 스택 유지**     | 일관성, 학습 비용 없음          | 복잡한 테이블 직접 구현 필요     |
| **UI 라이브러리 추가** | 빠른 개발, 완성도 높은 컴포넌트 | 번들 크기 증가, 스타일 충돌 가능 |
| **별도 프로젝트**      | 독립적 배포, 기술 스택 자유     | 코드 중복, 인증 연동 복잡        |

**권장**: 기존 스택 유지 + recharts(차트) + tanstack-table(테이블) 추가
